
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Will Anderson</title>
	<meta name="author" content="Will Anderson">

	
	<meta name="description" content="I bought a new Wi-Fi router about a year ago, and I&rsquo;ve been so happy with it that I decided to write a review. The Goods Netgear has a truly &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@itsananderson" />
    <meta name="twitter:title" content="Will Anderson" />
    <meta name="twitter:description" content="I bought a new Wi-Fi router about a year ago, and I&rsquo;ve been so happy with it that I decided to write a review. The Goods Netgear has a truly &hellip;" />

	<link href="http://william-backend.azurewebsites.net/feed/" rel="alternate" title="Will Anderson" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Will Anderson</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/work-with-me">Work With Me</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/work-with-me">Work With Me</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:willi.am">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/itsananderson" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/itsananderson" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="http://william-backend.azurewebsites.net/feed/" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:willi.am">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2015/02/04/netgear-nighthawk-ac1900-r7000-review/">
		
			Netgear Nighthawk AC1900 (R7000) Review</a>
	</h2>
	<div class="entry-content">
		<p>I bought a new Wi-Fi router about a year ago, and I&rsquo;ve been so happy with it that I decided to write a review.</p>

<h2>The Goods</h2>

<p>Netgear has a truly impressive lineup of high-quality routers in their Nighthawk series.</p>

<p>When I purchased the Nighthawk R7000, it was the only Nighthawk available, but now there are three options.</p>

<h3>Nighthawk AC1900 (R7000)</h3>

<p><a href="http://www.amazon.com/gp/product/B00F0DD0I6?ie=UTF8&amp;camp=213733&amp;creative=393185&amp;creativeASIN=B00F0DD0I6&amp;linkCode=shr&amp;tag=itsananderson-20&amp;linkId=BOLZOX4JTJAYBWR2"><img src="http://itsananderson.blob.core.windows.net/post-images/nighthawk-r7000.jpg" alt="" /></a></p>

<p>This is the router I purchased.
At $176, it is now the cheapest one in the series, but don&rsquo;t let that fool you.
It&rsquo;s a beast.</p>

<h3>Nighthawk X4 AC2350 (R7500)</h3>

<p><a href="http://www.amazon.com/gp/product/B00MRVJY5C?ie=UTF8&amp;camp=213733&amp;creative=393177&amp;creativeASIN=B00MRVJY5C&amp;linkCode=shr&amp;tag=itsananderson-20&amp;linkId=VIPUHQZWDGEZTHRJ&amp;f_rd_m=ATVPDKIKX0DER&amp;pf_rd_s=center-2&amp;pf_rd_r=15AA64WNHBH3N7C3AG2S&amp;pf_rd_t=101&amp;pf_rd_p=2034761682&amp;pf_rd_i=9524228011"><img src="http://itsananderson.blob.core.windows.net/post-images/nighthawk-r7500.jpg" alt="" /></a></p>

<p>This model has an additional antena, a faster processor, and boasts improved range and faster bandwidth. It costs about $100 more than the R7000. This router uses a more advanced radio than the R7000 that apparently has higher throughput and reliability. That being said, I haven&rsquo;t experienced any problems with the throughput or reliability of the R7000.</p>

<h3>Nighthawk X6 AC3200 (R8000)</h3>

<p><a href="http://www.amazon.com/gp/product/B00KWHMR6G?ie=UTF8&amp;camp=213733&amp;creative=393177&amp;creativeASIN=B00KWHMR6G&amp;linkCode=shr&amp;tag=itsananderson-20&amp;linkId=62Y4XCEYOOJRGP7I&amp;f_rd_m=ATVPDKIKX0DER&amp;pf_rd_s=center-2&amp;pf_rd_r=15AA64WNHBH3N7C3AG2S&amp;pf_rd_t=101&amp;pf_rd_p=2034761682&amp;pf_rd_i=9524228011"><img src="http://itsananderson.blob.core.windows.net/post-images/nighthawk-r8000.jpg" alt="" /></a></p>

<p>This model has 6 antenas, which again boosts range and bandwidth.
It also supports a third Wi-Fi band, and assigns slower and faster devices to different bands, boosting performance for fast devices.
This model is only about $5 more than the R7500 ($105 more than the R7000), so if I were to upgrade, this is the model I would choose, because of it&rsquo;s significantly improved bandwidth.</p>

<h2>Price</h2>

<p>Here&rsquo;s a side-by-side comparison of the different models.</p>

<table>
    <tr><th>Model</th><th>Price</th></tr>
    <tr><td>Nighthawk (R7000)</td><td>$176</td></tr>
    <tr><td>&nbsp;Nighthawk X4 (R7500)</td><td>$279</td></tr>
    <tr><td>&nbsp;Nighthawk X6 (R8000)</td><td>$283</td></tr>
</table>


<p>When I first considered this router, the price was what gave me the most pause.
In the past, the most I&rsquo;d paid for a router was about $40, so this seemed like a significant price bump.
In the end, the only reason I bought it was because a friend had bought one and was very happy with it.</p>

<p>After using it for a year, I don&rsquo;t think I&rsquo;ll ever buy a &ldquo;cheap&rdquo; router again.
In the case of Wi-Fi routers, it seems that &ldquo;you get what you pay for&rdquo; holds true.</p>

<h2>Reliability and Performance</h2>

<p>My primary reason for upgrading my router was that my previous router, an older Linksys in the $30-40 range, didn&rsquo;t reliably reach the entire house.
After enough complaints from one roommate who&rsquo;s bedroom was in the far corner of the house, I decided to upgrade.</p>

<p>After installing the R7000, I&rsquo;ve stopped having router issues.
The signal reaches to every corner of the house, and has never cut out.</p>

<p>I eventually even swapped out the Ethernet cables in my two desktop computers, replacing them with this <a href="http://www.amazon.com/gp/product/B007GMPZ0A?ie=UTF8&amp;camp=213733&amp;creative=393185&amp;creativeASIN=B007GMPZ0A&amp;linkCode=shr&amp;tag=itsananderson-20&amp;linkId=E3Z7SM7WKO2M3UVP&amp;psc=1">Dual Band Wireless PCI Express adapter</a>.
Even after getting rid of the hard line, I get blazing fast speeds on both machines.</p>

<h2>Extra Features</h2>

<h3>Mounting Slots</h3>

<p>One of the things I took advantage of immediately was the slots on the back for mounting it on a wall.
Moving the router to a more central location in my downstairs hallway provided even better coverage throughout the house.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/mounted-router.jpg" alt="" /></p>

<p><small><em>(yes, that&rsquo;s a Raspberry Pi unceremoniously dangling from the router. Don&rsquo;t judge me)</em></small></p>

<p>Pro tip: make sure there&rsquo;s a power outlet within easy reach of your desired location <strong>before</strong> you start screwing in drywall anchors :)</p>

<h3>Web-based WPS Button</h3>

<p>Most routers support WPS. This allows new clients to connect to a network by clicking a physical button on the router.
This is convenient, but who wants to have to get up and walk over to the router.</p>

<p>Fortunately the Nighthawk web UI has a button you can push to do the same thing.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/soft-wps-button.png" alt="" /></p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/wifi-client-connected.png" alt="" /></p>

<h3>Easy Firmware Upgrade</h3>

<p>Most of my past routers have had a really archaic update process. Usually you have to manually flash the firmware and go through a convoluted restart process.</p>

<p>The R7000, on the other hand, just requires one or two clicks to install the update and automatically restart.</p>

<h3>And So Much More</h3>

<p>I usually install DD-WRT on any router I buy, but the R7000 has all the features I typically use, so I&rsquo;m just running the stock firmware.
Here are a few of the things I use most frequently:</p>

<ul>
<li>View attached devices</li>
<li>Port forwarding</li>
<li>Assign static LAN IPs</li>
<li>View traffic statistics</li>
</ul>


<h2>In Conclusion</h2>

<p>If you&rsquo;re tired of buying cheap routers that crap out after a year or two, I highly recommend the <a href="http://www.amazon.com/gp/product/B00F0DD0I6?ie=UTF8&amp;camp=213733&amp;creative=393185&amp;creativeASIN=B00F0DD0I6&amp;linkCode=shr&amp;tag=itsananderson-20&amp;linkId=BOLZOX4JTJAYBWR2">Nighthawk R7000</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2015-02-04T22:13:14-08:00" pubdate data-updated="true">Feb 4<span>th</span>, 2015</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/review/'>Review</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/11/12/a-new-adventure-in-devdiv/">
		
			A New Adventure in DevDiv</a>
	</h2>
	<div class="entry-content">
		<p>Starting Monday, I&rsquo;m joining a new team at Microsoft.
Even though I&rsquo;m moving within the company, this will be a completely new experience, and I&rsquo;m pumped.</p>

<h2>What I&rsquo;ve Been Doing</h2>

<p>A year and a half ago, I joined a top-notch team working on <a href="http://blog.jongallant.com/2013/03/new-job-hiring-devs.html">a super secret Win8 app</a>.
A week after I started, our project was cancelled.
Oops :)</p>

<p>Our team was part of the Bing Ads org structure, so after a few months of limbo, we took ownership of the management and authoring tools for display ads.
Getting to work with this team of hand-picked developers has been an amazing experience.
I&rsquo;ve learned a ton about Agile methodologies, TDD, DevOps, and more.</p>

<p>I got to contribute to many projects in my time on the team, but here are the things I&rsquo;m most proud of:</p>

<ul>
<li>Building a RESTful API for storing, transforming, searching, and serving image and video assets</li>
<li>Building a purely static Angular SPA, backed by Node.js microservices</li>
<li>Converting most of the team&rsquo;s codebase to Git on Visual Studio Online, with CI through Octopus</li>
<li>Becoming a team resource for Git and JavaScript domain knowledge</li>
</ul>


<h2>What&rsquo;s Next</h2>

<p>I&rsquo;m joining the &ldquo;Client Platform Tools&rdquo; team inside DevDiv.
They work on the TypeScript language and tooling, as well as the JavaScript tooling in Visual Studio, and the F12 tools in Internet Explorer.</p>

<p>I&rsquo;ll be working on JavaScript profiling and diagnostics (think CPU/memory usage and network calls).
This will be a new experience for me.
I&rsquo;ve spent most of the last year and a half writing JavaScript for either the browser or Node, but now I&rsquo;ll be stepping a little deeper and working on the development tools themselves.
I&rsquo;ll also be jumping into TypeScript, the language in which most of the tools are written.</p>

<p>Thinking about everything I&rsquo;m going to be learning about and working on, I&rsquo;m excited, optimistic, and honestly a little scared.</p>

<p><strong>But that&rsquo;s good</strong>.</p>

<p>If changing teams didn&rsquo;t move me outside my comfort zone, it&rsquo;d be the wrong move.</p>

<p>I&rsquo;ve found that there are two things that get me pumped about what I&rsquo;m working on.
The first is that it&rsquo;s challenging.
I love learning, and it turns out working on problems I don&rsquo;t quite know how to solve is a great way to learn.</p>

<p>The second thing I love is doing work that makes a difference.
I don&rsquo;t only mean that in an altruistic sense, but in a broader, &ldquo;makes someone&rsquo;s job/life easier&rdquo; kind of way.
That&rsquo;s why a developer tools team was so appealing to me, and why I&rsquo;m so excited about what the next chapter will bring.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-11-12T16:40:57-08:00" pubdate data-updated="true">Nov 12<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/javascript/'>JavaScript</a>, <a class='category' href='/blog/categories/visual-studio/'>Visual Studio</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/10/28/ignoring-javascript-libraries-while-debugging/">
		
			Ignoring JavaScript Libraries While Debugging</a>
	</h2>
	<div class="entry-content">
		<p>Debugging front-end JavaScript can sometimes be painful.
When you rely on third-party libraries and frameworks, you find yourself stepping back and forth between the library&rsquo;s code and your own.
Most of the time, it&rsquo;s safe to assume that these third-party libraries are working correctly, so ignoring them can make it easier to keep your own code in your head.</p>

<p>Fortunately for us, Chrome, Firefox, and Internet Explorer each provide a way to ignore library code.</p>

<h3>Chrome</h3>

<p>In chrome, you can ignore a specific script by right clicking it in the &ldquo;Sources&rdquo; tab.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/chrome-blackbox-script.png" alt="" /></p>

<p>You can view the currently ignored patterns in the devtools settings page.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/chrome-blackbox-patterns.png" alt="" /></p>

<h3>Firefox</h3>

<p>Firefox is similar to Chrome, but you select the script in the &ldquo;Debugger&rdquo; tab, and click the eye icon to &ldquo;Toggle Black Boxing&rdquo;.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/firefox-blackbox-script.png" alt="" /></p>

<h3>Internet Explorer</h3>

<p>Internet explorer uses a different term, but the concept is the same.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/internet-explorer-mark-as-library.png" alt="" /></p>

<p>You can edit the exclusion list in:</p>

<p><code>%APPDATA%\..\LocalLow\Microsoft\F12\header\MyCode.json</code></p>

<p>or</p>

<p><code>%APPDATA%\..\Local\Microsoft\F12\header\MyCode.json</code></p>

<p>More info is available in the <a href="http://msdn.microsoft.com/en-us/library/ie/dn255007(v=vs.85).aspx#just_my_code">F12 tools documentation</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-10-28T14:33:06-07:00" pubdate data-updated="true">Oct 28<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/debugging/'>Debugging</a>, <a class='category' href='/blog/categories/javascript/'>JavaScript</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/10/14/unpacking-a-git-database/">
		
			Unpacking a Git Database</a>
	</h2>
	<div class="entry-content">
		<p>While writing the <a href="/blog/2014/10/14/for-the-last-time-git-stores-snapshots-not-diffs/">previous post</a>, I discovered a cool Git command which I thought I&rsquo;d share.</p>

<p>When you clone a Git repository, most Git hosts will send you a packed version of the database.
This is much more efficient than sending the raw Git objects, because duplicate content can be compressed.</p>

<p>However, if you want to inspect the object database with a file browser, it&rsquo;s hard to do so, because the content stays packed in a single file.
Unpacking is pretty simple.</p>

<p>If you unpack the <code>.pack</code> file while it&rsquo;s in the <code>.git/object/pack</code> folder, Git won&rsquo;t do anything, because it concludes that it already has all the objects contained in that <code>.pack</code>.
However, if you move the <code>.pack</code> file somewhere else, you can unpack it into your repository&rsquo;s database.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mv .git/object/pack/pack-*.pack .
</span><span class='line'>cat pack-*.pack | git unpack-objects
</span><span class='line'>rm pack-*.pack</span></code></pre></td></tr></table></div></figure>


<p>And there you have it.
Your packed objects are unpacked into <code>.git/objects/</code> folder.</p>

<p>This isn&rsquo;t something I recommend doing as a general practice, since it can take up significantly more space, but it&rsquo;s a useful thing to be able to do if you want to manually inspect your Git database.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-10-14T13:57:15-07:00" pubdate data-updated="true">Oct 14<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/git/'>Git</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/10/14/for-the-last-time-git-stores-snapshots-not-diffs/">
		
			For the Last Time: Git Stores Snapshots Not Diffs</a>
	</h2>
	<div class="entry-content">
		<p>I have this discussion every month or two, so it&rsquo;s finally time to write a blog post I can point people to instead.
<strong>Git stores a snapshot of the entire file, not a diff</strong></p>

<p>This is an understandable point of confusion, because most output from Git is in the form of diffs.
Additionally, many other SCMs store changes as diffs instead of snapshots.
However, Git stores an entire snapshot of each modified file.</p>

<p>If you want to see an explanation from someone much smarter than me, check out <a href="https://www.youtube.com/watch?v=rALm7BCCY-0#t=6m28s">this video</a>.</p>

<h2>Illustrating Snapshots</h2>

<p>The easiest way to show how Git stores snapshots is create a project and show the relative sizes of the .git object folder.</p>

<p>I&rsquo;ve created a <a href="https://github.com/itsananderson/alice">sample project on GitHub</a> that contains two commits.
The first commit introduces the text of Alice&rsquo;s Adventures in Wonderland.
The second commit makes a small modification to the text.</p>

<p>If you clone the repository and unpack the individual objects, you&rsquo;ll see something like the following when you inspect the .git directory with <a href="http://windirstat.info/">WinDirStat</a>.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/alice-windirstat.png" alt="" /></p>

<p>As you can see, Git stores two blobs of (nearly) identical size, one for each version of the text.
If Git stored diffs, you&rsquo;d expect to see one large blob, and a second much smaller blob (plus other objects for the tree etc.)</p>

<p>This isn&rsquo;t exactly a scientific proof about Git&rsquo;s behavior, but hopefully it illustrates it enough to get the point across.
If you want a more detailed explanation about how Git stores data, you can watch the YouTube video above, or read the Git documentation.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-10-14T10:15:11-07:00" pubdate data-updated="true">Oct 14<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/git/'>Git</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/10/12/understanding-nodes-require-function/">
		
			Understanding Node&#8217;s Require Function</a>
	</h2>
	<div class="entry-content">
		<p>I&rsquo;ve seen a few patterns lately that misunderstand Node&rsquo;s <code>require()</code> function, or simply fail to fully utilize it well.
Let&rsquo;s talk about some examples.</p>

<h2>Skipping the File Extension</h2>

<p>When you <code>require()</code> a file in Node, it checks a few possibilities:</p>

<ul>
<li>The exact file name</li>
<li>The file name with <code>.js</code> appended</li>
<li>The file name with <code>.json</code> appended</li>
</ul>


<p><em>Note: In case you weren&rsquo;t aware, Node has built-in support for <code>require</code>ing JSON files.
No need to manually read the file and call <code>JSON.parse</code>.</em></p>

<p>This means instead of doing <code>require('./foo.js')</code> you can do <code>require('./foo')</code>, and Node will figure it out.
I personally feel that it looks cleaner to leave off the file extension, but that&rsquo;s a matter of preference.
There is, however, at least one case I&rsquo;m aware of where leaving off the file extension improves the flexibility of your code.</p>

<p>Let&rsquo;s say you have a config for your app, stored in <code>config.json</code>.
Throughout your app you <code>require('./config.json')</code> to load the config.
Now what if you decide the config needs to execute dynamic code (to look up environment variables, for example)?
If you&rsquo;ve hardcoded the <code>.json</code> in your code, you&rsquo;ll have to find everywhere you&rsquo;ve used it and change the extension.</p>

<p>There are two ways to avoid this. The first is to just start with a <code>.js</code> file, even if it&rsquo;s a static config.
The second is to just <code>require('./config')</code> in your code, so that you can change the file extension without needing to update your code base.</p>

<h2>Modules Are Singletons</h2>

<p>When you load a module/file in Node, you&rsquo;ll always get the same instance.
Consider the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// a.js</span>
</span><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// main.js</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./a&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./a&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./a&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./a&#39;</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<p>Intuitively, it seems like main.js would print 4 different random numbers, but it actually prints the same random number 4 times.
This is because Node will only load a file once.
If you <code>require</code> the same file multiple times (even from different parts of your code), you&rsquo;ll get the same instance.</p>

<p>I&rsquo;ve seen code passing around objects between modules when they could just require the file again and get the same result.
Obviously there are good reasons, like dependency injection, for passing objects around, but sometimes it adds useless complexity.
In cases where you&rsquo;re only passing required objects around &ldquo;to get the same instance&rdquo;, just require the module where it&rsquo;s needed.</p>

<p>Now the question you should be asking is &ldquo;what if I <em>do</em> want different instances?&rdquo;.
The answer is to export a function, which can then be invoked to get a new instance.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// b.js</span>
</span><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">();</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// main.js</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">rand</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./b&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rand</span><span class="p">());</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rand</span><span class="p">());</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rand</span><span class="p">());</span>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">rand</span><span class="p">());</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Don&rsquo;t Load a Module&rsquo;s Submodule</h2>

<p>This example is obscure. I&rsquo;ve only seen it once, but it was a pain.</p>

<p>You can <em>technically</em> do something like this: <code>require('some-module/node_modules/some-submodule')</code> to load a dependency of a module you depend on, but you shouldn&rsquo;t.</p>

<p>The problem with this approach is that you&rsquo;re inferring a contract with the module&rsquo;s code that isn&rsquo;t present.
The author of that module could easily switch out &ldquo;some-submodule&rdquo; for something else, without considering that a breaking change.
Depending on how you&rsquo;re pinning your versions, you may find yourself with an updated module and broken code.</p>

<p>Instead, stop being lazy and install &ldquo;some-submodule&rdquo; as a direct dependency.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-10-12T09:24:25-07:00" pubdate data-updated="true">Oct 12<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/node/'>Node</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/09/25/only-run-one-suite-or-spec-in-jasmine/">
		
			Only Run One Suite or Spec in Jasmine</a>
	</h2>
	<div class="entry-content">
		<p>My team uses Karma (and thus Jasmine) to test our AngularJS applications.
Sometimes when a single test is failing, it&rsquo;s a pain to re-run every test while you iterate on a fix.</p>

<p>Turns out there&rsquo;s a way to only run a single suite of tests, or even a single test.</p>

<p>Suppose you have the following tests:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="err">“</span><span class="nx">my</span> <span class="nx">feature</span> <span class="nx">a</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">foo</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">bar</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="err">“</span><span class="nx">my</span> <span class="nx">feature</span> <span class="nx">b</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">foo</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">bar</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you have tests failing in &ldquo;my feature a&rdquo;, you can just run those tests by changing the <code>describe</code> call to a <code>ddescribe</code> call.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// Only this suite will run</span>
</span><span class='line'><span class="nx">ddescribe</span><span class="p">(</span><span class="err">“</span><span class="nx">my</span> <span class="nx">feature</span> <span class="nx">a</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">foo</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">bar</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="err">“</span><span class="nx">my</span> <span class="nx">feature</span> <span class="nx">b</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">foo</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">bar</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you&rsquo;ve narrowed down to a single spec, you can re-run that single spec by changing <code>it</code> to <code>iit</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="err">“</span><span class="nx">my</span> <span class="nx">feature</span> <span class="nx">a</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Only this spec will run</span>
</span><span class='line'>    <span class="nx">iit</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">foo</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">bar</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="err">“</span><span class="nx">my</span> <span class="nx">feature</span> <span class="nx">b</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">foo</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">bar</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you want to run multiple specs, you do that by simply changing each to <code>iit</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="err">“</span><span class="nx">my</span> <span class="nx">feature</span> <span class="nx">a</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// This spec will run</span>
</span><span class='line'>    <span class="nx">iit</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">foo</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">bar</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="err">“</span><span class="nx">my</span> <span class="nx">feature</span> <span class="nx">b</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// This spec will run</span>
</span><span class='line'>    <span class="nx">iit</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">foo</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="err">“</span><span class="nx">has</span> <span class="nx">a</span> <span class="nx">bar</span><span class="err">”</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// ...</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>This was a pretty useful discovery for me. Hopefully it is for you as well.</p>

<p><strong>Update</strong>: <a href="http://davidruttka.com">David Ruttka</a> has pointed out that you can also use <code>xdescribe</code> and <code>xit</code> to <em>disable</em> individual suites and tests.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-09-25T00:30:43-07:00" pubdate data-updated="true">Sep 25<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/jasmine/'>Jasmine</a>, <a class='category' href='/blog/categories/javascript/'>JavaScript</a>, <a class='category' href='/blog/categories/tdd/'>TDD</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/09/24/use-blob-storage-for-your-static-site-images/">
		
			Use Blob Storage for Your Static Site Images</a>
	</h2>
	<div class="entry-content">
		<p>The purpose of this post is to show how easy it is to use cloud storage for your static blog&rsquo;s binary resources.
I&rsquo;ll be showing specific examples for Azure Blob Storage and GitHub Pages, but the same principles should apply to AWS, as well as any other static blogging service.</p>

<h2>Avoid Large Binaries in Git</h2>

<p>When ever you check a file (or a change to an existing file) into Git, it stores a snapshot of the entire file.
This behavior has many nice benefits, but it means that large files can quickly bloat the size of a Git repository.</p>

<p>Culprits can include images, videos, and executables, to name a few.
Since we&rsquo;re specifically talking about static blogging, we&rsquo;ll focus on images.</p>

<p>Suppose you add an image to your post.
If the image takes up 200KB, you&rsquo;re automatically increasing your repository size by around 200KB (ignoring extra Git metadata).
Every time you modify that image, you&rsquo;re adding yet another 200KB.
Doing this for a few dozen blog posts can quickly balloon your repo.</p>

<p>Now imaging doing this with a GIF instead. Yikes.</p>

<h2>Move Your Images To Blob Storage</h2>

<p>I&rsquo;m not going to cover redirecting existing images to blob storage.
When I switched over, I had few enough images that I just decided to manually update the posts that referenced them.
If you have enough images, it may not be reasonable to manually update the posts that reference them. In that case, you can either try to automate it with a glorified perl script, or just leave the old posts alone and just upload new images to blob storage.</p>

<p>If you&rsquo;re using Azure for your images, you&rsquo;ll want to grab a copy of <a href="http://azurestorageexplorer.codeplex.com/">Azure Storage Explorer</a>. It&rsquo;s a handy little Windows application that gives you a CRUD view into your storage account. My <a href="http://willi.am/blog/2014/07/01/azure-blob-storage-and-node-first-steps/">series on Azure Blob Storage and Node</a> covers setting up your storage account and getting your access keys, so I won&rsquo;t go over that again. Just grab one of your access keys and paste it into the &ldquo;Storage account key&rdquo; field in Storage Explorer&rsquo;s &ldquo;Add Storage Account&rdquo; popup.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/setup-storage-explorer.png" alt="" /></p>

<p>As a last configuration step, open Tools &rarr; Options and go to the &ldquo;Content Types&rdquo; tab, then click &ldquo;Save Changes&rdquo;. Storage Explorer can automatically set content types based on file extensions, but for some reason it&rsquo;s not enabled by default. Opening and saving the options seems to be enough to activate it.</p>

<p><img src="http://itsananderson.blob.core.windows.net/post-images/configure-storage-explorer.png" alt="" /></p>

<p>Now that you&rsquo;ve configured Storage Explorer, you can upload your images. First, create a container. Make sure you set permissions to &ldquo;Public Container&rdquo; or &ldquo;Public Blob&rdquo; so the images can be seen by unauthenticated users.</p>

<p>Now, inside the container, click &ldquo;Upload&rdquo;. You can select multiple images. Once they&rsquo;ve uploaded, double check that their content types are correct. The default is application/octet-stream, which most browsers will try to download, rather than display as an image. The public URL for a given image is pretty easy to get from the storage account, container, and blob name, but if you&rsquo;re not sure, just double click the blob, and it&rsquo;ll show you the public URL.</p>

<p>That&rsquo;s about it. Happy blogging.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-09-24T01:37:53-07:00" pubdate data-updated="true">Sep 24<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/azure/'>Azure</a>, <a class='category' href='/blog/categories/octopress/'>Octopress</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/09/16/introducing-edge-git/">
		
			Introducing Edge-Git</a>
	</h2>
	<div class="entry-content">
		<p>I&rsquo;ve recently been frustrated by the lack of functional Node bindings for <a href="https://libgit2.github.com/">libgit2</a>.
The most prominent projects are <a href="https://github.com/libgit2/node-gitteh">node-gitteh</a> and <a href="">nodegit</a>.
Unfortunately both repositories are severely lacking in features and documentation.
I couldn&rsquo;t even install node-gitteh on Windows, and I spent an unsuccessful evening trying to get nodegit to do something as simple as fetching changes.</p>

<p>Eventually I came to the conclusion that no libgit2 bindings for Node are functional enough for my use.</p>

<p>I&rsquo;d used <a href="https://github.com/libgit2/libgit2sharp">LibGit2Sharp</a> for a .NET project in the past.
It&rsquo;s an amazingly high-quality project.
While the documentation is sparse, the copious unit tests make it easy to figure out how to accomplish different tasks.</p>

<p>I&rsquo;d read about <a href="http://tjanczuk.github.io/edge/">Edge.js</a>, which lets you interop between .NET and Node, but hadn&rsquo;t actually done anything with it.
Since I had a seemingly perfect use case, I decided to dive in.</p>

<p>About a week later, I have a very basic initial release of <a href="https://www.npmjs.org/package/edge-git">edge-git.</a>
About all you can do at this point is init, clone, and query branches/commits, but I&rsquo;m steadily adding more bindings to the existing LibGit2Sharp functionality.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-09-16T22:50:30-07:00" pubdate data-updated="true">Sep 16<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/git/'>Git</a>, <a class='category' href='/blog/categories/node/'>Node</a>


</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/08/16/gulp-automation-path-abstraction/">
		
			Gulp Automation: Path Abstraction</a>
	</h2>
	<div class="entry-content">
		<p>If you use Gulp for anything more than a trivial project, you&rsquo;ll find that you reference paths <em>a lot</em>.
Paths for sources, paths for destinations.
Paths to watch for changes.
You get the picture.</p>

<p>Without some organization, things can quickly get out of hand.</p>

<h2>Store Paths In Variables</h2>

<p>As tempting as it might be to shove an extra path into a task definition, resist the urge.
Instead, define your paths as variables.
This allows you to share and compose path groups without repetition.</p>

<p>As an example, consider a common use case.
You want to lint your JavaScript for your application code and tests, but you only want to minify your application code and run tests against your test code.
You could approach it like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;lint&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">([</span><span class="s1">&#39;app/*.js&#39;</span><span class="p">,</span> <span class="s1">&#39;test/*.js&#39;</span><span class="p">])</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">lint</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;minify&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">([</span><span class="s1">&#39;app/*.js&#39;</span><span class="p">])</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">lint</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">([</span><span class="s1">&#39;test/*.js&#39;</span><span class="p">])</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">lint</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>This isn&rsquo;t bad, but things can quickly get out of hand.
At this point already, if you moved your application code to a folder called &lsquo;src&rsquo;, you&rsquo;d have to update your gulpfile in two places.
Three if you&rsquo;d added a &lsquo;watch&rsquo; task.</p>

<p>When you abstract your paths, you can reuse them throughout your gulpfile.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">appPaths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;app/*.js&#39;</span><span class="p">];</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">testPaths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;test/*.js&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;lint&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">appPaths</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">testPaths</span><span class="p">))</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">lint</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;minify&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">appPaths</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">minify</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">testPaths</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">test</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Again, this is a simple example, but hopefully it illustrates the point.</p>

<h2>Breaking Into <code>require</code>able Pieces</h2>

<p>Once your paths are in variables, you can abstract them further by putting them their own file.</p>

<p>To illustrate, suppose you have Karma tests.
Karma uses its own configuration file, but gulp-karma overrides some if them, which can make it hard to avoid duplicating configurations.
Consider the following config:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// karma.conf.js</span>
</span><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">config</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">files</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="s1">&#39;vendor/angular.js&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;app/*.js&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;test/*.js&#39;</span>
</span><span class='line'>        <span class="p">],</span>
</span><span class='line'>        <span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">],</span>
</span><span class='line'>        <span class="nx">autoWatch</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">frameworks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;jasmine&#39;</span><span class="p">],</span>
</span><span class='line'>        <span class="nx">browsers</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;PhantomJS&#39;</span><span class="p">],</span>
</span><span class='line'>        <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="s1">&#39;karma-jasmine&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;karma-spec-reporter&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;karma-phantomjs-launcher&#39;</span>
</span><span class='line'>        <span class="p">],</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Not too bad, but again, we&rsquo;re duplicating logic.
Back in the gulpfile, we&rsquo;ll have a task like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">vendorPaths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vendor/angular.js&#39;</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;karma&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">vendorPaths</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">appPaths</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">testPaths</span><span class="p">))</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">karma</span><span class="p">({</span> <span class="nx">configFile</span><span class="o">:</span> <span class="s1">&#39;karma.conf.js&#39;</span> <span class="p">}));</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>Suddenly, there&rsquo;s path duplication between the Karma config file and the gulpfile.
To fix this, simply define your paths in another file that&rsquo;s included by both.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;app/*.js&#39;</span><span class="p">];</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;test/*.js&#39;</span><span class="p">];</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">vendor</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;vendor/angular.js&#39;</span><span class="p">];</span>
</span><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">app</span><span class="o">:</span> <span class="nx">app</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">test</span><span class="o">:</span> <span class="nx">test</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">vendor</span><span class="o">:</span> <span class="nx">vendor</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">karma</span><span class="o">:</span> <span class="nx">vendor</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">app</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then your gulpfile should look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">var</span> <span class="nx">paths</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./paths&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;lint&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">test</span><span class="p">))</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">lint</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;minify&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">app</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">minify</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">test</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">test</span><span class="p">());</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">gulp</span><span class="p">.</span><span class="nx">task</span><span class="p">(</span><span class="s1">&#39;karma&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">gulp</span><span class="p">.</span><span class="nx">src</span><span class="p">(</span><span class="nx">paths</span><span class="p">.</span><span class="nx">karma</span><span class="p">)</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">karma</span><span class="p">({</span> <span class="nx">configFile</span><span class="o">:</span> <span class="s1">&#39;karma.conf.js&#39;</span> <span class="p">}));</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>And your karma.conf.js can look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// karma.conf.js</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">paths</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./paths&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">config</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span>
</span><span class='line'>        <span class="nx">files</span><span class="o">:</span> <span class="nx">paths</span><span class="p">.</span><span class="nx">karma</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">reporters</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;spec&#39;</span><span class="p">],</span>
</span><span class='line'>        <span class="nx">autoWatch</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>        <span class="nx">frameworks</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;jasmine&#39;</span><span class="p">],</span>
</span><span class='line'>        <span class="nx">browsers</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;PhantomJS&#39;</span><span class="p">],</span>
</span><span class='line'>        <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="s1">&#39;karma-jasmine&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;karma-spec-reporter&#39;</span><span class="p">,</span>
</span><span class='line'>            <span class="s1">&#39;karma-phantomjs-launcher&#39;</span>
</span><span class='line'>        <span class="p">],</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>There you have it.
Nice and DRY.</p>

<p>Here&rsquo;s a <a href="https://gist.github.com/itsananderson/61bad88e4470679a4f13">Gist of the completed example</a>.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-08-16T00:57:44-07:00" pubdate data-updated="true">Aug 16<span>th</span>, 2014</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/gulp/'>Gulp</a>


</div>
	
</div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/2/" class="prev">Prev</a>
    
    
        <a href="/blog/page/4/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2018

    Will Anderson

</footer>
	<script src="/javascripts/slash.js"></script>





<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '7508815';
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/7508815.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6776456-2', 'willi.am');
  ga('send', 'pageview');

</script>

</body>
</html>